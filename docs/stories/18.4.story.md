# Story 18.4: Agency Public Profile Display

## Status: Ready

## Story

As a **platform visitor**,
I want **to view detailed agency profiles with team and client information**,
So that **I can evaluate their expertise and decide whether to engage with them**.

## Story Context

**New System Integration:**
- Integrates with: Agency directory, listing system for company logos, versioning system
- Technology: Next.js 14, React, TypeScript, Swiper.js for carousel
- Follows pattern: Similar to existing listing detail pages
- Touch points: Public routing, image CDN, listing associations

## Acceptance Criteria

**Functional Requirements:**

1. **Profile Access**: Clicking agency tile navigates to `/agents/[agency-slug]` profile page
2. **Profile Header**: Display agency logo, name, classification badge, geographic patch
3. **Company Introduction**: Show description text (from approved version only)
4. **Team Section**: 
   - Grid display of team members with headshots
   - Show name and title under each headshot
   - Click to navigate to individual team member page
   - Graceful handling of missing headshots (initials fallback)
5. **Companies We Work With**:
   - Carousel of company logos from linked listings
   - Pull logos dynamically from listings where `linked_agency_id` matches
   - Click logo to navigate to company's requirements
   - Show "No current clients" message if no linked listings
6. **Contact Information**: Display main office contact details with clickable email/phone

**Display Requirements:**

7. Only show content from latest approved agency version
8. 404 page for non-existent or non-approved agencies
9. Responsive design for mobile/tablet/desktop
10. Loading states for dynamic content

**SEO Requirements:**

11. Meta tags with agency name and description
12. Open Graph tags for social sharing
13. Structured data (JSON-LD) for organization
14. Canonical URL handling

## Technical Notes

**Implementation Approach:**
- Server-side rendering for SEO
- Cache assembled profile data (1-hour TTL)
- Lazy load team member images
- Virtual scrolling for large teams

**Component Structure:**
```
/app/agents/[slug]/page.tsx - Profile page
/components/agency/AgencyProfile.tsx - Main profile component
/components/agency/TeamGrid.tsx - Team members display
/components/agency/CompanyCarousel.tsx - Client logos carousel
/lib/agency-profile.ts - Data fetching and assembly
```

**Data Fetching:**
```typescript
// Fetch approved version
const approvedVersion = await getApprovedAgencyVersion(agencyId);

// Fetch linked companies
const linkedCompanies = await getLinkedCompanies(agencyId);

// Assemble profile data
const profile = assembleAgencyProfile(approvedVersion, linkedCompanies);
```

**Performance Optimizations:**
- Use Next.js Image for optimized loading
- Implement intersection observer for lazy loading
- Cache company logos at edge
- Prefetch team member pages on hover

## Definition of Ready

- [x] Acceptance criteria defined
- [x] Technical approach documented
- [x] URL structure defined
- [ ] Design mockups approved
- [ ] Carousel library confirmed
- [ ] Story pointed by team

## Definition of Done

- [ ] Profile page implemented
- [ ] Team grid with navigation working
- [ ] Company carousel functional
- [ ] Version-based content display
- [ ] SEO meta tags implemented
- [ ] Responsive design complete
- [ ] Performance optimizations applied
- [ ] Unit tests >80% coverage
- [ ] E2E tests for navigation flows
- [ ] Cross-browser testing
- [ ] Lighthouse score >90
- [ ] Documentation updated
- [ ] Deployed to staging
- [ ] Product Owner sign-off