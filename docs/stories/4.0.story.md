# Story 4.0: Public Directory Search Interface

## Status: Draft

## Story

- As a **prospective landlord or property professional**
- I want to search and browse property requirement listings through a public directory interface
- so that I can discover potential tenant opportunities and view their specific requirements

## Acceptance Criteria (ACs)

1. **Public Search Interface**: Create accessible public directory page with search functionality
2. **Listing Cards**: Display listing summaries in card format with key information (company, size, location)
3. **Search & Filters**: Implement search by company name, location, and basic filters (size range, sector)
4. **Listing Details View**: Full listing detail view with all information and contact details
5. **Responsive Design**: Mobile-first responsive design using "Violet Bloom" design system
6. **Performance**: Fast loading with proper pagination and optimized queries
7. **No Authentication Required**: Public access without login requirement
8. **Contact Information Display**: Show occupier contact details for landlord outreach

## User Prerequisites

Before development begins, the user must:
1. **Search UX**: Approve search interface design and user flow
2. **Information Architecture**: Confirm which listing fields are publicly visible
3. **Contact Privacy**: Approve contact information display policy

## Tasks / Subtasks

- [ ] Task 1: Public Directory Page Setup (AC: 1, 5)
  - [ ] Create public directory route `/directory` 
  - [ ] Implement responsive layout with "Violet Bloom" design system
  - [ ] Add public navigation header without authentication requirements
  - [ ] Create initial page structure and SEO optimization

- [ ] Task 2: Listing Cards & Grid (AC: 2, 5, 6)
  - [ ] Create ListingCard component with key information display
  - [ ] Implement responsive grid layout (1 col mobile, 2-3 col desktop)
  - [ ] Add company logo, name, size range, and location summary
  - [ ] Include sector badges and key requirement highlights
  - [ ] Optimize card loading with skeleton states

- [ ] Task 3: Search & Filter Implementation (AC: 3, 6)
  - [ ] Add search bar with debounced company/location search
  - [ ] Implement filter sidebar: size range, sector, use class
  - [ ] Add location-based filtering (city/region)
  - [ ] Create filter state management with URL synchronization
  - [ ] Add clear filters and results count display

- [ ] Task 4: Listing Detail View (AC: 4, 8)
  - [ ] Create detailed listing view page `/directory/[id]`
  - [ ] Display complete listing information: requirements, descriptions, FAQs
  - [ ] Show contact information: name, title, email, phone
  - [ ] Add company brochures and supporting documents for download
  - [ ] Include back to directory navigation with preserved search state

- [ ] Task 5: API & Data Layer (AC: 6)
  - [ ] Create public API endpoints for listing retrieval
  - [ ] Implement search and filtering with optimized database queries
  - [ ] Add pagination for large result sets
  - [ ] Create proper error handling for public access
  - [ ] Add listing status filtering (only show approved listings)

- [ ] Task 6: Performance & SEO (AC: 6)
  - [ ] Implement proper meta tags and OpenGraph data
  - [ ] Add structured data markup for search engines
  - [ ] Optimize image loading and caching
  - [ ] Add analytics tracking for search behavior
  - [ ] Test performance across devices and connections

## Definition of Ready

- [ ] Public directory design approved
- [ ] Information display policy confirmed
- [ ] Contact privacy approach validated
- [ ] Search functionality requirements finalized

## Definition of Done

- [ ] Public directory accessible without authentication
- [ ] Search and filtering functionality working
- [ ] Listing cards and details display correctly
- [ ] Responsive design verified across devices
- [ ] Performance metrics meet standards (LCP < 2s)
- [ ] SEO optimization implemented
- [ ] Contact information properly displayed

## Dev Technical Guidance

### API Endpoints

```typescript
// Public listing endpoints
GET /api/public/listings          // Search and list
GET /api/public/listings/[id]     // Individual listing
GET /api/public/listings/stats    // Directory statistics
```

### Database Queries

```sql
-- Public listings view (approved only)
SELECT 
  id, company_name, title, description,
  site_size_min, site_size_max, 
  sector, use_class,
  contact_name, contact_title, contact_email, contact_phone,
  created_at, updated_at
FROM listings 
WHERE status = 'approved' 
  AND published = true
ORDER BY created_at DESC;
```

### Component Structure

```
/directory/
├── page.tsx                 // Main directory page
├── [id]/page.tsx           // Listing detail page
└── components/
    ├── ListingCard.tsx     // Individual listing card
    ├── SearchFilters.tsx   // Search and filter UI
    ├── ListingGrid.tsx     // Responsive grid layout
    └── ListingDetail.tsx   // Full listing display
```

## Testing Requirements

- [ ] Search functionality with various queries
- [ ] Filter combinations and clearing
- [ ] Responsive design across breakpoints  
- [ ] Contact information display accuracy
- [ ] Page loading performance
- [ ] SEO and accessibility compliance

## Dependencies

**Required Completed Stories**:
- **Story 3.0** (Database Schema)
- **Story 3.1** (Listing Creation) 
- **Story 3.4** (Design System)

## Estimated Effort

**Story Points**: 8
**Sprint Capacity**: 1 sprint (5-8 days)

## Success Metrics

- **Page Load Performance**: LCP < 2 seconds
- **Search Response Time**: < 500ms for typical queries
- **Mobile Usability**: Google Mobile-Friendly test pass
- **Accessibility**: WCAG 2.2 AA compliance