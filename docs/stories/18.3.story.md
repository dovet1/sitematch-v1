# Story 18.3: Team Member Management

## Status: Ready

## Story

As an **agency owner** (the user who created the agency),
I want **to manage team member profiles within my agency listing**,
So that **potential clients can see our team's expertise and connect with specific agents**.

## Story Context

**Existing System Integration:**
- Integrates with: Agency profile system, image upload infrastructure, version control
- Technology: Next.js 14, React, TypeScript, react-beautiful-dnd for drag-drop
- Follows pattern: Existing contact management in listings
- Touch points: Agency edit interface, file upload system, versioning workflow

## Acceptance Criteria

**Functional Requirements:**

1. **Add Team Member**: Form with fields:
   - Name (required)
   - Title/Role (required)
   - Bio (1000 character limit)
   - Email (validated format)
   - Phone (international format support)
   - LinkedIn URL (optional)
   - Headshot upload
2. **Headshot Processing**: 
   - Accept JPG/PNG up to 5MB
   - Auto-crop to square aspect ratio
   - Generate optimized versions (200x200, 100x100)
3. **Team List Management**:
   - View all team members in grid or list view
   - Edit existing team member details
   - Delete team members with confirmation
   - Maximum 50 team members per agency
4. **Reordering**: Drag-and-drop to reorder team members with auto-save
5. **Version Control**: Any team changes create new agency version in draft status

**Mobile Requirements:**

6. Touch-friendly interface for mobile editing
7. Alternative to drag-drop on mobile (up/down buttons)
8. Responsive form layout

**Validation Requirements:**

8. Required fields: name, title
9. Email format validation
10. Phone number format validation (international)
11. Bio character limit enforcement
12. Headshot file type and size validation

## Technical Notes

**Implementation Approach:**
- Use react-beautiful-dnd for desktop drag-drop
- Implement touch-friendly reorder buttons for mobile
- Store display_order field for consistent ordering
- Batch updates to minimize version creation

**Component Structure:**
```
/components/agency/TeamManager.tsx - Main management interface
/components/agency/TeamMemberForm.tsx - Add/edit form
/components/agency/TeamMemberCard.tsx - Individual member display
/components/agency/TeamReorderList.tsx - Draggable list component
```

**Database Schema:**
```sql
CREATE TABLE agency_team_members (
  id UUID PRIMARY KEY,
  agency_id UUID REFERENCES agencies(id),
  name VARCHAR(255) NOT NULL,
  title VARCHAR(255) NOT NULL,
  bio TEXT,
  email VARCHAR(255),
  phone VARCHAR(50),
  linkedin_url VARCHAR(255),
  headshot_url VARCHAR(500),
  display_order INTEGER,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);
```

**Image Storage:**
- Path structure: `/agencies/{agency_id}/team/{member_id}/headshot_{size}.{ext}`
- CDN delivery with cache headers

## Definition of Ready

- [x] Acceptance criteria defined
- [x] Technical approach documented
- [x] Drag-drop library selected
- [ ] UI mockups approved
- [ ] Image processing pipeline confirmed
- [ ] Story pointed by team

## Definition of Done

- [ ] CRUD operations for team members complete
- [ ] Headshot upload and processing working
- [ ] Drag-drop reordering implemented
- [ ] Mobile-friendly alternative controls
- [ ] Version creation on changes
- [ ] Form validation complete
- [ ] Unit tests >80% coverage
- [ ] Integration tests for team operations
- [ ] Cross-browser testing
- [ ] Accessibility testing
- [ ] Documentation updated
- [ ] Deployed to staging
- [ ] Product Owner sign-off